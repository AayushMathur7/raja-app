"Code for the following raja-app-main/tickets.jsonl: \n {\"name\": \"Unhandled runtime error\", \"type\": \"Bug\", \"description\": \"An unhandled runtime error was encountered in Speakers.jsx. The issue is caused by a ReferenceError as mediaVariable is not defined, which results in a failure during the execution.\", \"acceptance_criteria\": \"The reference error should be fixed, and the addEventListener method call on the mediaVariable variable should be successful. There should be no runtime errors related to undefined variables in Speakers.jsx, and all functionality dependent on the mediaVariable variable should work as expected.\", \"how_to_reproduce\": \"The error is located at line 172 in the Speakers.jsx file. The steps to reproduce this error are not yet fully identified, so further investigation is required to determine the sequence of actions leading to this error.\", \"status\":  \"ready_to_deploy\"}\n{\"name\": \"Embeddings compute prefix error\", \"type\": \"Bug\", \"description\": \"There's a type error in the embeddings.compute_prefix_and_zip_url function. It fails when a non-string argument is passed.\", \"acceptance_criteria\": \"The compute_prefix_and_zip_url function should handle non-string inputs gracefully without throwing a type error. It should provide a meaningful error message indicating the incorrect input type.\", \"how_to_reproduce\": \"This error can be reproduced by calling the compute_prefix_and_zip_url function with a non-string argument. Further investigation is required to determine if there are other inputs that could lead to this error.\", \"status\":  \"ready_to_deploy\"}\n{\"name\": \"New endpoint that provides status of embedding workflow\", \"type\": \"Feature\", \"description\": \"We need an endpoint that provides status of the embedding workflow. This endpoint should return the current stage of the workflow and estimated time for completion.\", \"acceptance_criteria\": \"A new endpoint /v1/status should be created that returns a JSON response with the current stage of the workflow and an estimated time to completion. The endpoint should handle errors gracefully and provide meaningful messages in case of failures.\", \"how_to_reproduce\": \"\", \"status\":  \"ready_to_deploy\"}\n{\"name\": \"Intermittent failure of run-raja endpoint\", \"type\": \"Bug\", \"description\": \"The /v1/run-raja endpoint is failing intermittently with a 500 internal server error. The error message indicates a failure in the raja.raja_agent function.\", \"acceptance_criteria\": \"The /v1/run-raja endpoint should handle failures in the raja_agent function gracefully and provide meaningful error messages to the client. It should not return a 500 internal server error.\", \"how_to_reproduce\": \"This error can be reproduced by making multiple concurrent requests to the /v1/run-raja endpoint. Further investigation is required to determine the exact conditions leading to the error.\", \"status\":  \"ready_to_deploy\"}\n{\"name\": \"Logging to debug flask app\", \"type\": \"Feature\", \"description\": \"We need to add logging to our Flask app to better track and debug errors. The logs should capture key actions like starting and completing the embedding workflow, starting and completing the Raja workflow, and any errors.\", \"acceptance_criteria\": \"Logging should be added to the Flask app. The logs should be written to a file that can be reviewed later. It should log key events in the application, including starting and completing workflows and any errors. The logs should include timestamps, the event description, and any relevant details.\", \"how_to_reproduce\": \"\", \"status\":  \"ready_to_deploy\"}\n Code for the following raja-app-main/src/api/dashboard.jsx: \n export const initializeRepo = async (userEmailId, userEmail, repoLink) => {\n    try {\n        const response = await fetch('http://localhost:5000/v1/initialize-repo', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json'\n            },\n            body: JSON.stringify({ user_id: userEmailId, user_email: userEmail, repo_url: repoLink })\n        });\n\n        if (!response.ok) {\n            throw new Error(`HTTP error! status: ${response.status}`);\n        }\n\n        // If response contains any data that you want to return, parse and return it here\n        // return await response.json();\n    } catch (error) {\n        console.error(\"Failed to initialize repo:\", error);\n    }\n}\n\nexport const rajaAgent = async (details) => {\n    try {\n        const response = await fetch('http://localhost:5000/v1/run-raja', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json'\n            },\n            body: JSON.stringify({ details: details })\n        });\n\n        if (!response.ok) {\n            throw new Error(`HTTP error! status: ${response.status}`);\n        }\n\n    } catch (error) {\n        console.error(\"Failed to run raja agent:\", error);\n    }\n}\n\nexport const getTickets = async () => {\n    try {\n        const response = await fetch('http://localhost:5000/v1/get-tickets', {\n            method: 'GET',\n            headers: {\n                'Content-Type': 'application/json'\n            },\n        });\n\n        if (!response.ok) {\n            throw new Error(`HTTP error! status: ${response.status}`);\n        }\n\n        const data = await response.json();\n        return data;\n\n    } catch (error) {\n        console.error(\"Failed to fetch tickets:\", error);\n    }\n}\n\nexport const createTicket = async (ticketData) => {\n    try {\n        const response = await fetch('http://localhost:5000/v1/create-ticket', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json'\n            },\n            body: JSON.stringify(ticketData),\n        });\n\n        if (!response.ok) {\n            throw new Error(`HTTP error! status: ${response.status}`);\n        }\n\n    } catch (error) {\n        console.error(\"Failed to create ticket:\", error);\n    }\n} Code for the following raja-app-main/server/app.py: \n import os\nfrom pprint import pprint\n\nimport embeddings\nimport raja\nfrom dotenv import load_dotenv\nfrom flask import Flask, jsonify, request\nfrom flask_cors import CORS, cross_origin\nfrom ghapi.all import GhApi\n\nfrom convex import ConvexClient\n\napp = Flask(\"Raja\")\ncors = CORS(app)\n\n# get the directory of the current script\ncurrent_dir = os.path.dirname(os.path.abspath(__file__))\n\n# go up one level to get the root directory\nroot_dir = os.path.dirname(current_dir)\n\ndotenv_path = os.path.join(root_dir, \".env.local\")\n\n# load the .env file\nload_dotenv(dotenv_path)\n\nclient = ConvexClient(os.getenv(\"NEXT_PUBLIC_CONVEX_URL\"))\nGH_TOKEN = os.getenv(\"GH_TOKEN\", \"\")\n\n\n@app.route(\"/v1/initialize-repo\", methods=[\"POST\"])\n@cross_origin()\ndef initialize_repo():\n    req_data = request.get_json()\n    user_id = req_data[\"user_id\"]\n    user_email = req_data[\"user_email\"]\n    repo_url = req_data[\"repo_url\"]\n\n    try:\n        folder_path, zip_url = embeddings.compute_prefix_and_zip_url(repo_url)\n        embeddings.execute_embedding_workflow(zip_url, folder_path)\n        repo_owner, repo_name = embeddings.get_repo_info(repo_url)\n        client.mutation(\n            \"repo:addRepo\",\n            {\n                \"user_id\": user_id,\n                \"user_email\": user_email,\n                \"url\": repo_url,\n                \"owner\": repo_owner,\n                \"name\": repo_name,\n            },\n        )\n    except ValueError as e:\n        return jsonify(error=str(e)), 400\n    return jsonify(message=\"Embedding workflow executed successfully\"), 200\n\n\n@app.route(\"/v1/run-raja\", methods=[\"POST\"])\ndef run_raja():\n    print(\"Running Raja\")\n    req_data = request.get_json()\n    print(req_data)\n    try:\n        raja.raja_agent(req_data)\n    except Exception as e:\n        return jsonify(error=str(e)), 400\n    return jsonify(message=\"Raja workflow executed successfully\"), 200\n\n\n@app.route(\"/v1/delete-all-except-main\", methods=[\"POST\"])\ndef delete_all_except_main():\n    req_data = request.get_json()\n    repo_owner = req_data[\"repo_owner\"]\n    repo_name = req_data[\"repo_name\"]\n    ghapi = GhApi(owner=repo_owner, repo=repo_name, token=GH_TOKEN)\n\n    # Get all branches\n    branches = ghapi.repos.list_branches()\n\n    for branch in branches:\n        # Delete the branch if its name is not 'main'\n        if branch.name != \"main\":\n            try:\n                ghapi.git.delete_ref(ref=f\"heads/{branch.name}\")\n                print(f\"Deleted branch: {branch.name}\")\n            except Exception as e:\n                print(f\"Error deleting branch {branch.name}: {e}\")\n\n    return {}\n\n\n@app.route(\"/v1/get-tickets\", methods=[\"GET\"])\ndef get_tickets():\n    tickets = client.query(\"tickets:get\")\n    print(tickets)\n    return tickets\n\n\n@app.route(\"/v1/create-ticket\", methods=[\"POST\"])\ndef create_ticket():\n    req_data = request.get_json()\n    print(req_data)\n    client.mutation(\"tickets:createTicket\", req_data)\n    return {}\n\n\nif __name__ == \"__main__\":\n    app.run(port=5000, debug=True) Code for the following raja-app-main/src/api/dashboard.jsx: \n export const initializeRepo = async (userEmailId, userEmail, repoLink) => {\n    try {\n        const response = await fetch('http://localhost:5000/v1/initialize-repo', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json'\n            },\n            body: JSON.stringify({ user_id: userEmailId, user_email: userEmail, repo_url: repoLink })\n        });\n\n        if (!response.ok) {\n            throw new Error(`HTTP error! status: ${response.status}`);\n        }\n\n        // If response contains any data that you want to return, parse and return it here\n        // return await response.json();\n    } catch (error) {\n        console.error(\"Failed to initialize repo:\", error);\n    }\n}\n\nexport const rajaAgent = async (details) => {\n    try {\n        const response = await fetch('http://localhost:5000/v1/run-raja', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json'\n            },\n            body: JSON.stringify({ details: details })\n        });\n\n        if (!response.ok) {\n            throw new Error(`HTTP error! status: ${response.status}`);\n        }\n\n    } catch (error) {\n        console.error(\"Failed to run raja agent:\", error);\n    }\n}\n\nexport const getTickets = async () => {\n    try {\n        const response = await fetch('http://localhost:5000/v1/get-tickets', {\n            method: 'GET',\n            headers: {\n                'Content-Type': 'application/json'\n            },\n        });\n\n        if (!response.ok) {\n            throw new Error(`HTTP error! status: ${response.status}`);\n        }\n\n        const data = await response.json();\n        return data;\n\n    } catch (error) {\n        console.error(\"Failed to fetch tickets:\", error);\n    }\n}\n\nexport const createTicket = async (ticketData) => {\n    try {\n        const response = await fetch('http://localhost:5000/v1/create-ticket', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json'\n            },\n            body: JSON.stringify(ticketData),\n        });\n\n        if (!response.ok) {\n            throw new Error(`HTTP error! status: ${response.status}`);\n        }\n\n    } catch (error) {\n        console.error(\"Failed to create ticket:\", error);\n    }\n} "
